# Keccak算法

## 一、背景与历史

- **提出时间**：2008 年
- **设计者**：Guido Bertoni, Joan Daemen（AES 设计者之一）, Michaël Peeters, Gilles Van Assche
- **NIST SHA-3 竞赛**：2007–2012 年，Keccak 在 64 个候选算法中胜出，于 2015 年正式发布为 **FIPS 202**（即 SHA-3 标准）
- **目标**：
  - 提供与 SHA-2 不同的设计理念（避免“所有鸡蛋放在一个篮子里”）
  - 抵抗未来可能对 Merkle–Damgård 结构的攻击（如长度扩展攻击）


### 二、基本特性

- **结构**：基于 **[海绵结构](./doc/keccak.md)**（sponge construction），不同于传统的 Merkle–Damgård 结构（如 SHA-1/SHA-2）。
- **输入输出**：
  - 可处理任意长度的输入。
  - 可生成任意长度的输出（在 SHA-3 标准中，通常固定为 224、256、384 或 512 位）。
- **安全性**：
  - 抗碰撞（collision resistance）
  - 抗原像（preimage resistance）
  - 抗第二原像（second preimage resistance）
  - 对长度扩展攻击免疫（得益于海绵结构）


### 三、SHA-3 与原始 Keccak 的区别

虽然 NIST 采纳 Keccak 作为 SHA-3，但 **SHA-3 并不完全等同于原始 Keccak 提交版本**：

- 主要区别在于 **填充规则**（padding）：
  - 原始 Keccak 使用 `10*1` 填充。
  - SHA-3 使用 **`1010...101`（即 `0x06` 开头的域分离符）**，具体为 `10*1` 但前缀加了一个 `01`（即 `0x06` 字节），以实现与 SHA-2 等的域分离。
  - 因此，**Keccak(“abc”) ≠ SHA3-256(“abc”)**，除非特别指定使用原始 Keccak。

> 注意：很多库（如 Python 的 `pysha3` 或 `hashlib`）默认实现的是 **标准 SHA-3**，而非原始 Keccak。若需原始 Keccak（如用于 Ethereum 的 Keccak-256），需使用特定实现（如 `keccak` 库）。


### 四、应用场景

- **区块链**：Ethereum 使用 **Keccak-256**（注意：是原始 Keccak，不是 SHA3-256）作为其哈希函数。
- **密码学协议**：可构建 MAC、伪随机函数（PRF）、流密码等（通过海绵结构的灵活性）。
- **后量子安全**：目前未发现有效量子攻击，被视为后量子时代候选算法之一。

Keccak 算法是一种先进的密码学哈希函数，因其被 NIST 选为 **SHA-3 标准**而广为人知。以下是对 Keccak 的**全面、系统、深入**的详细介绍，涵盖其设计原理、数学结构、安全特性、实现细节及应用。


## 五、安全性分析

- **抗碰撞性**：目前无有效攻击，理论安全强度为 \( c/2 \)
- **抗原像**：同样为 \( c/2 \) 比特
- **已知最佳攻击**：
  - 对缩减轮数（如 5~6 轮）存在理论攻击
  - 对完整 24 轮 **无实用攻击**
- **侧信道攻击**：可通过恒定时间实现防御
- **量子安全**：Grover 算法下仍保持 \( c/2 \) 量子安全（符合预期）


## 六、性能与实现

- **软件性能**：略慢于 SHA-2（因 24 轮复杂操作），但可优化（如 SIMD、位切片）
- **硬件性能**：极佳！适合 ASIC/FPGA，吞吐量高、面积小
- **轻量级变种**：Keccak 可配置为更小状态（如 200、400 比特），用于物联网设备


## 七、扩展应用（基于海绵结构）

Keccak 不仅是哈希函数，还可构建：

- **XOF**（可扩展输出函数）：如 SHAKE128、SHAKE256（输出任意长度）
- **KMAC**：基于 Keccak 的 MAC
- **TupleHash / ParallelHash**：处理多字段或多块数据
- **伪随机函数（PRF）**、**流密码**


## 八、总结

Keccak 代表了现代密码学哈希函数的新范式：

- 创新的海绵结构  
- 强大的安全保证  
- 灵活的多功能性  
- 优秀的硬件效率  
- 与 SHA-2 正交，增强生态系统多样性

尽管在通用软件中不如 SHA-2 快，但其**安全性、灵活性和未来适应性**使其成为密码学基础设施的重要组成部分。
