# DES算法

DES（Data Encryption Standard，数据加密标准）是一种对称密钥加密算法，由IBM在1970年代初开发，并于1977年被美国国家标准局（NBS，现为NIST）采纳为联邦信息处理标准（FIPS PUB 46）。尽管如今DES因密钥长度过短（56位）已不再安全，但它在密码学发展史上具有重要地位，并为后续算法（如3DES、AES）奠定了基础。

[FIPS 46-3标准](https://csrc.nist.gov/pubs/fips/46-3/final)

## 一、基本特性

- **对称加密**：加密和解密使用相同的密钥。
- **分组长度**：64位明文分组。
- **密钥长度**：名义上64位，但其中8位用于奇偶校验，实际有效密钥长度为56位。
- **轮数**：16轮Feistel结构迭代。
- **操作类型**：主要基于位置换（Permutation）、异或（XOR）、S盒（Substitution Box）等。

## 二、DES整体结构（Feistel网络）

DES采用经典的 **Feistel结构**，其核心思想是将输入数据分为左右两半（各32位），每一轮对右半部分进行函数变换后与左半部分异或，然后交换左右两部分。

### 加密流程概览：

1. **初始置换（IP）**  
   对64位明文进行固定位置的重新排列（不增加安全性，仅为历史原因保留）。

2. **16轮Feistel迭代**  
   每轮使用一个48位的子密钥（从主密钥派生），执行以下步骤：
   - 将当前右半部分（R）扩展为48位（通过E扩展表）。
   - 与本轮子密钥进行异或。
   - 通过8个6→4的**S盒**进行非线性替换（这是DES安全性的核心）。
   - 对S盒输出（32位）进行P置换（固定置换）。
   - 与左半部分（L）异或，得到新的右半部分；原右半部分成为新的左半部分。

3. **最终交换与逆初始置换（IP⁻¹）**  
   16轮结束后，左右两部分交换（注意：最后一轮不交换，但在实现中通常仍交换后再用IP⁻¹抵消），再进行初始置换的逆操作，输出64位密文。

> 注：解密过程与加密几乎相同，只是子密钥使用顺序相反（从K₁₆到K₁）。

## 三、关键组件详解

### [0. 初始置换（Initial Permutation）](./doc/initial_permutation.md)
- 对64位明文进行固定位置的重新排列

### [1. 密钥调度（Key Schedule）](./doc/key_schedule.md)
- 输入：64位原始密钥（含8位奇偶校验位）。
- 步骤：
  - 去掉奇偶位，得到56位有效密钥。
  - 通过PC-1置换表打乱顺序，分为C₀和D₀（各28位）。
  - 每轮对C和D进行**循环左移**（1位或2位，依轮数而定）。
  - 合并Cᵢ和Dᵢ，通过PC-2表压缩为48位子密钥Kᵢ。

### [2. S盒（Substitution Boxes）](./doc/substitution_boxes.md)
- 共8个S盒，每个接收6位输入，输出4位。
- S盒是非线性、精心设计的查找表，提供混淆（confusion）能力。
- 是DES抵抗差分密码分析的关键。

### [3. 扩展函数 E（Expansion Function）](./doc/expansion_function.md)
- 将32位右半部分扩展为48位，通过重复某些位实现。
- 目的是使输入与48位子密钥匹配，并引入扩散（diffusion）。

### [4. P 置换（Permutation P-Box）](./doc/permutation_pbox.md)
- 对S盒输出的32位进行固定位置重排，增强扩散效果。

## 四、安全性与局限性

- **密钥空间小**：2⁵⁶ ≈ 7.2×10¹⁶，现代计算能力可在短时间内暴力破解（如1998年EFF的“Deep Crack”机器可在几天内破解）。
- **存在理论攻击**：如差分密码分析、线性密码分析，但对完整16轮DES仍不实用（需大量已知明文）。
- **已被淘汰**：NIST于2005年正式弃用DES，推荐使用AES。

> 衍生算法：**3DES（Triple DES）** 通过三次DES加密（如加密-解密-加密）提升安全性，密钥长度可达112或168位，目前仍在部分系统中使用。

## 五、总结

DES虽然不再安全，但其设计思想（Feistel结构、S盒、密钥调度等）深刻影响了现代分组密码的发展。理解DES有助于掌握对称加密的基本原理和密码分析方法。
