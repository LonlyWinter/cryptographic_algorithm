# 模减法（mod_sub）

在 Verilog 中实现 **模减法（mod_sub）** 是 ECC（椭圆曲线密码学）硬件设计中的另一个基础模块。模减的定义是：

$$
c = (a - b) \bmod p
$$

其中 $ a, b \in [0, p) $，$ p $ 是一个素数（如 secp256k1 的 $ p = 2^{256} - 2^{32} - 977 $）。


### 模减的关键点：
- 如果 $ a \geq b $，结果就是 $ a - b $
- 如果 $ a < b $，结果就是 $ a - b + p $（等价于加上模数使其非负）
- 因为 $ 0 \leq a, b < p $，所以 $ -p < a - b < p $，只需 **最多加一次 p** 即可归约到 $ [0, p) $

因此，模减可以用 **一次减法 + 一次条件加法** 实现，无需除法！


### 在 ECC 点加中的典型用途

- 计算斜率分子：$ y_2 - y_1 \rightarrow \text{mod\_sub}(y2, y1, p) $
- 计算斜率分母：$ x_2 - x_1 \rightarrow \text{mod\_sub}(x2, x1, p) $
- 计算 $ x_1 - x_3 $ 等中间值

所有这些都必须在模 $ p $ 下进行，且结果保持非负。


### 注意事项

- 输入 `a` 和 `b` 必须满足 $ 0 \leq a, b < p $，否则结果可能不正确。
- 输出 `c` 自动满足 $ 0 \leq c < p $。

