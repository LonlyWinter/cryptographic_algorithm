# 判别式（discriminant）

“判别式”（discriminant）在椭圆曲线中用于判断曲线是否有奇点，它的形式  
$$
\Delta = -16(4a^3 + 27b^2)
$$  
并不是凭空出现的，而是从**代数几何**和**多项式理论**中自然导出的结果。


## 一、背景：奇点的代数定义

对于一条平面代数曲线，由方程 $ f(x, y) = 0 $ 定义，一个点 $ (x_0, y_0) $ 是**奇点**，当且仅当：

$$
f(x_0, y_0) = 0,\quad
\frac{\partial f}{\partial x}(x_0, y_0) = 0,\quad
\frac{\partial f}{\partial y}(x_0, y_0) = 0
$$

也就是说，函数值和两个偏导数在该点都为零——这表示曲线在该点“不光滑”，没有唯一确定的切线。


## 二、应用到椭圆曲线

我们考虑标准的短 Weierstrass 形式（适用于特征 ≠ 2, 3 的域）：

$$
y^2 = x^3 + ax + b
$$

将其改写为隐函数形式：

$$
f(x, y) = y^2 - x^3 - ax - b = 0
$$

计算偏导数：

- $ \frac{\partial f}{\partial x} = -3x^2 - a $
- $ \frac{\partial f}{\partial y} = 2y $

设存在奇点 $ (x_0, y_0) $，则必须同时满足：

1. $ y_0^2 = x_0^3 + a x_0 + b $  （在曲线上）
2. $ -3x_0^2 - a = 0 $  → $ 3x_0^2 = -a $
3. $ 2y_0 = 0 $  → $ y_0 = 0 $（在特征 ≠ 2 的域中）

将 (2) 和 (3) 代入 (1)：

- 因为 $ y_0 = 0 $，所以左边为 0；
- 右边为 $ x_0^3 + a x_0 + b = 0 $

现在用 (2) 中的 $ a = -3x_0^2 $ 代入上式：

$$
x_0^3 + (-3x_0^2) x_0 + b = x_0^3 - 3x_0^3 + b = -2x_0^3 + b = 0
$$
→ $ b = 2x_0^3 $

现在我们有：
- $ a = -3x_0^2 $
- $ b = 2x_0^3 $

接下来，我们想消去 $ x_0 $，得到一个只含 $ a $ 和 $ b $ 的条件。

从 $ a = -3x_0^2 $ 得到 $ x_0^2 = -a/3 $，所以  
$ x_0^3 = x_0 \cdot x_0^2 = x_0 \cdot (-a/3) $

但更直接的方法是：把 $ a $ 和 $ b $ 表达成 $ x_0 $ 的函数，然后构造一个不变量。

计算：
$$
4a^3 + 27b^2 = 4(-3x_0^2)^3 + 27(2x_0^3)^2 = 4(-27x_0^6) + 27(4x_0^6) = -108x_0^6 + 108x_0^6 = 0
$$

所以：**存在奇点 ⇒ $ 4a^3 + 27b^2 = 0 $**

反过来，如果 $ 4a^3 + 27b^2 = 0 $，我们可以解出某个 $ x_0 $ 满足上述关系，从而构造出奇点。

因此：

> **曲线 $ y^2 = x^3 + ax + b $ 有奇点 ⇔ $ 4a^3 + 27b^2 = 0 $**


## 三、为什么判别式是 $ \Delta = -16(4a^3 + 27b^2) $？

上面我们得到了核心部分 $ 4a^3 + 27b^2 $，但完整的判别式包含因子 $-16$，这是为了与[**一般 Weierstrass 方程**](./weierstrass.md)的判别式保持一致，并使其在代数几何中有更好的性质（例如模形式理论中的归一化）。

一般 Weierstrass 方程为：
$$
y^2 + a_1 xy + a_3 y = x^3 + a_2 x^2 + a_4 x + a_6
$$

其判别式 $ \Delta $ 是一个复杂的表达式。当我们通过变量替换将它简化为短形式（即 $ y^2 = x^3 + ax + b $），在特征 ≠ 2, 3 的域中，可以证明：

$$
\Delta = -16(4a^3 + 27b^2)
$$

这个 $-16$ 在特征 ≠ 2 的域中是非零常数，因此**是否为零**只取决于 $ 4a^3 + 27b^2 $。所以在密码学中，我们通常只检查：

$$
4a^3 + 27b^2 \not\equiv 0 \pmod{p}
$$

因为只要这个不为零，$\Delta \neq 0$，曲线就光滑。

> 小知识：在特征为 2 或 3 的域中，不能使用短 Weierstrass 形式，需要其他形式（如 Edwards 曲线、Montgomery 曲线等），判别式也不同。


## 四、类比：二次方程的判别式

你可能熟悉二次方程 $ ax^2 + bx + c = 0 $ 的判别式 $ D = b^2 - 4ac $：

- 若 $ D = 0 $，方程有重根（图像与 x 轴相切）；
- 类似地，在椭圆曲线中，$ \Delta = 0 $ 表示三次多项式 $ x^3 + ax + b $ 有**重根**，导致曲线在对应点出现奇点。

事实上，令 $ f(x) = x^3 + ax + b $，则：
- $ y^2 = f(x) $
- 如果 $ f(x) $ 有重根（即 $ f(x) $ 与 $ f'(x) $ 有公共根），那么在该 $ x $ 处 $ y = 0 $，且导数也为零 → 奇点！

而三次多项式的判别式正是 $ -4a^3 - 27b^2 $（符号可能因定义而异），与我们上面的结果一致。


## 五、总结

| 步骤 | 内容 |
|------|------|
| 1. | 奇点 ⇔ 函数值和所有一阶偏导为零 |
| 2. | 对 $ f(x,y) = y^2 - x^3 - ax - b $ 求偏导 |
| 3. | 解出奇点存在的条件 → 推出 $ 4a^3 + 27b^2 = 0 $ |
| 4. | 完整判别式为 $ \Delta = -16(4a^3 + 27b^2) $，来自一般 Weierstrass 理论 |
| 5. | 在密码学中只需检查 $ 4a^3 + 27b^2 \not\equiv 0 \pmod{p} $ |

因此，**判别式是从奇点的代数定义出发，通过求导和消元自然推导出来的**，它本质上反映了三次多项式是否有重根，从而决定曲线是否光滑。
