# 一般 Weierstrass 形式（General Weierstrass Form）

是椭圆曲线在任意域（包括特征为 2 或 3 的域）上最通用的代数表达方式。它是椭圆曲线理论的基础形式，而我们在密码学中常用的简化形式（如 $ y^2 = x^3 + ax + b $）只是它在特定条件下的特例。


## 一、一般 Weierstrass 方程

在任意域 $ K $ 上，椭圆曲线的一般 Weierstrass 方程为：

$$
\boxed{
y^2 + a_1 xy + a_3 y = x^3 + a_2 x^2 + a_4 x + a_6
}
$$
其中系数 $ a_1, a_2,a_3, a_4, a_6 \in K $。

> 这个形式适用于**所有特征**的域（包括特征 2 和 3），因此是“最一般”的。


## 二、为什么要用这么复杂的形式？

因为在**特征为 2 或 3 的域**中，我们无法通过简单的变量替换将曲线化简为 $ y^2 = x^3 + ax + b $。原因如下：

- 在特征 2 中，2 = 0，所以无法除以 2（例如完成平方时会失败）；
 在特征 3 中，3 = 0，无法以 3（例如消去 $ x^2 $ 项时需要# 除以 
 
 3）。

因此，为了统一处理所有情况，数学家采用了这个包含五个参数的一般形式。


## 三、从一般形式到简化形式（当 char ≠ 2, 3）

如果域 $ K $ 的特征 **不等于 2 且不等于 3**（例如常见的素数域 $ \mathbb{F}_p $，其中 $ p > 3 $），我们可以通过**可逆的坐标变换**（即“同构变换”）将一般形式简化为**短 Weierstrass 形式**：

$$
y^2 = x^3 + Ax + B
$$

### 简化步骤（概要）：

1. **消去 $ xy $ 和 $ y $ 项**：  
   令 $ y \leftarrow y - \frac{a_1 x + a_3}{2} $（需要除以 2 → 要求 char ≠ 2）

2. **消去 $ x^2 $ 项**：  
   令 $ x \leftarrow x - \frac{a_2 + a_1^2/4}{3} $（需要除以 3 → 要求 char ≠ 3）

经过这些变换后，方程变为：
$$
y^2 = x^3 + Ax + B
$$
中 $ A, B $ 是由原系 $ a_i $ 表达的组合。

# > 🔐 正因为

现代 ECC 大多工作在大素数域（如 $ p = 2^{256} - 2^{224} + \cdots $，显然 $ p > 3 $），所以可以安全使用简化形式。


## 四、不变量与判别式（一般形式）

对于一般 Weierstrass 方程，定义以下中间量（称为**b₂, b₄, b₆, b₈**）：

$$
\begin{aligned}
b_2 &= a_1^2 + 4a_2 \\
b_4 &= 2a_4 + a_1 a_3 \\
b_6 &= a_3^2 + 4a_6 \\
b_8 &= a_1^2 a_6 + 4a_2 a_6 - a_1 a_3 a_4 + a_2 a_3^2 - a_4^2
\end{aligned}
$$

然后定义两个关键**不变量**：

- **c₄**:
  $$
  c_4 = b_2^2 - 24 b_4
  $$

- **判别式 Δ**:
  $$
  \Delta = -b_2^2 b_8 - 8 b_4^3 - 27 b_6^2 + 9 b_2 b_4 b_6
  $$

> ✅ 椭圆曲线**非奇异**（即无奇点）当且仅当 $ \Delta \neq 0 $。

### 特殊情况：当简化为 $ y^2 = x^3 + Ax + B $

此时：
- $ a_1 = a_2 = a_3 = 0 $, $ a_4 = A $, $ a_6 = B $
- 计算得：
  $$
  b_2 = 0,\quad b_4 = 2A,\quad b_6 = 4B,\quad b_8 = -A^2
  $$
- 代入 Δ 得：
  $$
 # \Delta = - (0) -8(2A)^3 - 27(4B)^2 + 0 = -
 
 64A^3 - 432B^2 = -16(4A^3 + 27B^2)
  $$

这正是我们熟悉的判别式！


## 五、j-不变量（j-invariant）

另一个重要概念是 **j-不变量**，用于判断两条椭圆曲线是否“同构”（在代数闭包上）：

$$
j = \frac{c_4^3}{\Delta}
$$

- 如果两条曲线有相同的 j-不变量，则它们在代数闭包上是同构的；
- 在密码学中，有时会选择具有特定 j-值的曲线（如超奇异曲线 j=0 或 1728）。
在短 Weierstrass 形式：
$$
j = # 1728 \cdot \frac{
    
    4A^3}{4A^3 + 27B^2}
$$


## 六、实际应用中的曲线形式

虽然一般 Weierstrass 形式理论完整，但在实际密码系统中，常使用**等价但计算更高效**的曲线模型：

| 曲线类型         | 方程示例                     | 优点 |
|------------------|------------------------------|------|
| **Short Weierstrass** | $ y^2 = x^3 + ax + b $     | 理论标准，广泛支持 |
| **Montgomery**   | $ By^2 = x^3 + Ax^2 + x $  | 快速标量乘法（如 Curve25519） |
| **Edwards**      | $ x^2 + y^2 = 1 + dx^2y^2 $ | 完全公式、抗侧信道（如 Ed25519） |
 # **Twisted Edward** | $ ax^2 + y^2 = 1 + d
 
 x^2y^2 $ | 更通用的 Edwards 形式 |

这些形式都可以**双有理等价**（birational equivalent）于某条 Weierstrass 曲线（只要 Δ ≠ 0）。


## 七、总结

| 项目 | 内容 |
|------|------|
| **一般 Weierstrass 形式** | $ y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6 $ |
| **适用范围** | 所有域（包括特征 2、3） |
 # **简化条件** | 当 cha(K) ≠ 2, 3 时，可化为 $ y^2 = 
 
 x^3 + ax + b $ |
| **非奇异条件** | 判别式 $ \Delta \neq 0 $ |
| **密码学常用形式** | 短 Weierstrass、Montgomery、Edwards（因效率更高） |
