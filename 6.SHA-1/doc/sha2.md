# SHA-2算法

SHA-2（Secure Hash Algorithm 2）是一组由美国国家安全局（NSA）设计、美国国家标准与技术研究院（NIST）于2001年发布的密码学哈希函数家族。它是 SHA-1 的继任者，旨在提供更强的安全性，并已成为当前广泛使用的标准哈希算法。


### 一、SHA-2 家族成员

SHA-2 并不是一个单一算法，而是一个**算法族**，主要成员包括：

| 算法       | 摘要长度（位） | 内部块大小 | 常见用途 |
|------------|----------------|------------|--------|
| SHA-224    | 224            | 512 位     | 较少使用 |
| **SHA-256**| **256**        | **512 位** | **最常用**（TLS、区块链、文件校验等） |
| SHA-384    | 384            | 1024 位    | 高安全需求场景 |
| **SHA-512**| **512**        | **1024 位**| 高性能/高安全环境 |
| SHA-512/224| 224            | 1024 位    | 兼容性变种 |
| SHA-512/256| 256            | 1024 位    | 兼容性变种 |

> 最常用的是 **SHA-256** 和 **SHA-512**。


### 二、基本特性

- **输入**：任意长度的消息。
- **输出**：固定长度的摘要（如 SHA-256 输出 256 位 = 32 字节 = 64 位十六进制字符串）。
- **设计基础**：基于 Merkle–Damgård 结构，与 SHA-1 类似，但使用更复杂的轮函数和更大的内部状态。
- **安全性目标**：
  - 抗原像性（Pre-image resistance）
  - 抗第二原像性（Second pre-image resistance）
  - 抗碰撞性（Collision resistance）

截至目前（2026年），**SHA-2 尚未发现有效的实际碰撞攻击**，被认为是**密码学安全的**。


### 三、工作原理（以 SHA-256 为例）

1. **消息填充（Padding）**：
   - 添加 `1` 比特；
   - 填充 `0` 比特，使总长度 ≡ 448 (mod 512)；
   - 附加 64 位原始消息长度（以比特为单位）。

2. **初始化哈希值**：
   - 使用 8 个 32 位初始寄存器（H₀ 到 H₇），其值来源于前 8 个质数的平方根的小数部分的前 32 位。

3. **主压缩函数**：
   - 每个 512 位消息块经过 **64 轮**非线性运算；
   - 使用两个关键函数：
     - **Ch(x, y, z) = (x ∧ y) ⊕ (¬x ∧ z)**
     - **Ma(x, y, z) = (x ∧ y) ⊕ (x ∧ z) ⊕ (y ∧ z)**
   - 使用 64 个常量（K₀ 到 K₆₃），来源于前 64 个质数的立方根的小数部分。

4. **输出拼接**：
   - 将最终的 H₀–H₇ 拼接成 256 位摘要。


### 四、安全性与现状

- **无已知实用碰撞攻击**（截至 2026 年）；
- 被 NIST、ISO、IETF 等广泛推荐；
- 是 TLS 1.2/1.3、比特币（使用 SHA-256）、PGP、SSH、代码签名等的核心组件；
- 被视为 **SHA-1 的安全替代方案**。

> ⚠️ 注意：虽然 SHA-2 安全，但 NIST 也已标准化 **SHA-3**（基于 Keccak，结构完全不同），作为长期备份。


### 五、与 SHA-1 的关键区别

| 特性         | SHA-1               | SHA-256（代表 SHA-2）      |
|--------------|---------------------|----------------------------|
| 摘要长度     | 160 位              | 256 位                     |
| 内部状态     | 5 × 32 位           | 8 × 32 位                  |
| 轮数         | 80 轮               | 64 轮                      |
| 安全性       | 已被攻破（碰撞）    | 目前安全                   |
| 常量来源     | 平方根              | 平方根 + 立方根            |
| 推荐使用     | ❌ 禁止              | ✅ 广泛推荐                 |


### 六、应用场景

- **数字证书**（SSL/TLS）
- **区块链**（比特币使用 SHA-256 双重哈希）
- **软件分发校验**（如 Linux ISO 校验和）
- **密码存储**（通常与盐值 + HMAC 或 PBKDF2 结合使用）
- **Git**（正在从 SHA-1 迁移至 SHA-256）


### 总结

SHA-2 是目前**最主流、最可信的哈希算法家族**，尤其 **SHA-256** 几乎成为行业默认标准。在需要密码学安全性的任何场景中，应优先选择 SHA-2 而非 SHA-1。
