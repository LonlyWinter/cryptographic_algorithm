# SHA-1算法

SHA-1（Secure Hash Algorithm 1）是一种密码学哈希函数，由美国国家安全局（NSA）设计，并由美国国家标准与技术研究院（NIST）于1995年发布为联邦信息处理标准（[FIPS PUB 180-1](https://csrc.nist.gov/pubs/fips/180-1/final)）。它属于SHA（Secure Hash Algorithm）家族的早期成员。


### 一、基本特性

- **输入**：任意长度的消息。
- **输出**：固定长度为 **160 位**（即 20 字节，通常表示为 40 位十六进制字符串）的消息摘要（hash 值）。
- **设计目标**：具有抗碰撞性、抗原像性和抗第二原像性（尽管这些安全性在现代已被削弱）。


### 二、[工作原理（简要）](./doc/sha1.md)

SHA-1 的核心流程包括：

1. **消息填充（Padding）**：
   - 在原始消息末尾添加一个 `1` 比特；
   - 然后填充若干个 `0` 比特，使得总长度 ≡ 448 (mod 512)；
   - 最后附加一个 64 位的大端序整数，表示原始消息的比特长度。

2. **初始化哈希值**：
   - 使用 5 个 32 位的初始寄存器（H₀ 到 H₄），其初始值是固定的常量（基于平方根和立方根的前32位）。

3. **主循环处理**：
   - 将填充后的消息划分为 512 位的块；
   - 对每个块执行 80 轮的压缩函数（使用非线性函数、循环左移、常量等）；
   - 更新中间哈希值。

4. **输出**：
   - 将最终的 H₀–H₄ 连接起来，形成 160 位的摘要。


### 三、安全性现状

- **已不安全**：自 2005 年起，研究人员陆续发现 SHA-1 的理论碰撞攻击；
- **实际碰撞**：2017 年，Google 与 CWI Amsterdam 合作发布了 **SHAttered 攻击**，首次在现实中构造出两个不同 PDF 文件但具有相同 SHA-1 哈希值；
- **弃用建议**：
  - NIST 于 2011 年禁止在数字签名等安全应用中使用 SHA-1；
  - 主流浏览器和证书颁发机构早已停止支持 SHA-1 证书；
  - 推荐改用 **[SHA-2](./doc/sha2.md)**（如 SHA-256）或 **SHA-3**。


### 四、应用场景（历史）

- Git 版本控制系统曾广泛使用 SHA-1 标识对象（但 Linus Torvalds 强调 Git 的 SHA-1 主要用于校验而非安全，且正在逐步迁移到 SHA-256）；
- 旧版 SSL/TLS 证书；
- 文件完整性校验（现已不推荐）。


### 总结

虽然 SHA-1 曾经被广泛应用，但由于已被证明存在实际可行的碰撞攻击，**不应再用于任何需要密码学安全性的场景**。现代系统应优先采用 SHA-256 或更高安全级别的哈希算法。
