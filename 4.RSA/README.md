# RSA算法

RSA算法是一种**非对称加密算法**，由Ron Rivest、Adi Shamir 和 Leonard Adleman 于1977年提出，因此得名 RSA。它是现代密码学中最广泛使用的公钥加密算法之一，常用于数据加密、数字签名和密钥交换等场景。


## 一、基本原理

RSA 的安全性基于**大整数分解难题**：将两个大素数相乘很容易，但将一个大合数分解为其两个素因子却非常困难（尤其当这两个素数足够大时）。


## 二、密钥生成步骤

1. **选两个大质数**  
   随机选择两个很大的、不相同的质数，比如叫它们 p 和 q。

2. **计算一个大数 n**  
   把 p 和 q 相乘，得到 n。这个 n 会同时出现在公钥和私钥里。

3. **计算欧拉函数值**  
   用 (p - 1) 乘以 (q - 1)，得到一个叫 phi 的数（也写作 φ(n)）。这个数在后续步骤中很重要，但不会公开。

4. **选一个公钥指数 e**  
   找一个整数 e，要求它比 phi 小，而且和 phi 没有公共因数（即“互质”）。通常大家会直接用 65537，因为它效率高又安全。

5. **算出私钥指数 d**  
   找一个数 d，使得 e 乘以 d 除以 phi 后余数是 1。换句话说，d 是 e 关于 phi 的“模反元素”。这一步需要用专门的数学方法（比如扩展欧几里得算法）来算。

6. **组成密钥对**  
   - 公钥 = (e, n) → 可以随便分享  
   - 私钥 = (d, n) → 必须严格保密


## 三、加解密过程

- **加密**（别人用你的公钥）  
  把要发送的明文（必须是一个小于 n 的数字）用公钥中的 e 和 n 进行幂运算，再对 n 取余，得到密文。

- **解密**（你自己用私钥）  
  拿到密文后，用私钥中的 d 和 n 做类似的幂运算再取余，就能还原出原始明文。

> 实际使用中，明文通常先被转换成数字（比如通过编码），而且因为 RSA 加密速度慢，一般只用来加密一个临时的对称密钥（比如 AES 密钥），真正的数据用对称加密处理。

> RSA 的加密/解密 = 模幂运算

## 四、数字签名

RSA 也可以反过来用作**数字签名**：

- **签名**：你用自己的私钥对一段信息的“摘要”（比如 SHA-256 哈希值）进行加密，生成签名。
- **验证**：别人用你的公钥解密这个签名，得到摘要，再自己对原始信息算一次摘要，如果两者一致，就说明信息确实是你发的，且没被篡改。


## 五、安全性说明

- 当前推荐的 RSA 密钥长度至少是 **2048 位**，更安全的场景建议用 3072 位或 4096 位。
- 如果 p 和 q 太小、太接近、或者生成时不够随机，都可能被攻击者破解。
- 不要直接用 RSA 加密长消息——效率低，还可能引入漏洞。
- 实际系统中，RSA 通常和对称加密（如 AES）配合使用，发挥各自优势。


## 六、常见用途

- HTTPS/TLS 中的密钥交换
- SSH 登录认证
- 数字证书（如 X.509）
- 软件签名验证
- 加密小段敏感数据（如密码、密钥）


